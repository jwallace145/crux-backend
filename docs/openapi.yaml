openapi: 3.0.3
info:
  title: Crux Backend API
  description: |
    The Crux Backend API provides comprehensive endpoints for managing climbing activities, user authentication, and user profiles.

    ## Authentication
    The API uses JWT tokens stored in HTTP-only cookies for authentication:
    - Access tokens are short-lived (used for API requests)
    - Refresh tokens are long-lived (used to obtain new access tokens)

    ## Response Format
    All endpoints return a standardized response structure containing:
    - Service metadata (service_name, version, environment)
    - Request tracking (request_id, timestamp)
    - Status and message
    - Data payload or error details
  version: 1.0.0
  contact:
    name: API Support
    url: https://github.com/jwallace145/crux-backend

servers:
  - url: http://localhost:3000
    description: Local development server - Use this to test local changes
  - url: http://dev-api.cruxproject.io
    description: Development server - Use this to test deployed changes

tags:
  - name: Health
    description: Health check endpoints
  - name: Authentication
    description: User authentication and session management
  - name: Users
    description: User management operations
  - name: Climbs
    description: Climb logging and retrieval
  - name: Gyms
    description: Climbing gym management and discovery
  - name: Training Sessions
    description: Training session logging and management

paths:
  /health:
    get:
      tags:
        - Health
      summary: Health check
      description: Returns the health status of the API service
      operationId: healthCheck
      responses:
        '200':
          description: Service is healthy
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIResponse'
              example:
                service_name: crux-backend
                version: "1.0.0"
                environment: development
                api_name: health_check
                request_id: "123e4567-e89b-12d3-a456-426614174000"
                timestamp: "2024-01-01T12:00:00Z"
                status: success
                message: CruxBackend API is running
                data:
                  status: healthy
                  uptime: "2024-01-01 12:00:00 +0000 UTC"

  /login:
    post:
      tags:
        - Authentication
      summary: User login
      description: |
        Authenticate a user with username/email and password.

        Accepts either username OR email (not both) along with password.
        Returns user data and sets HTTP-only cookies for access and refresh tokens.
      operationId: login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            examples:
              usernameLogin:
                summary: Login with username
                value:
                  username: johndoe
                  password: securepassword123
              emailLogin:
                summary: Login with email
                value:
                  email: john@example.com
                  password: securepassword123
      responses:
        '200':
          description: Login successful
          headers:
            Set-Cookie:
              schema:
                type: string
              description: Sets access_token and refresh_token cookies
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/LoginResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /logout:
    post:
      tags:
        - Authentication
      summary: User logout
      description: |
        Log out the current user by revoking their session and clearing cookies.

        Requires a valid access token in cookies.
      operationId: logout
      security:
        - cookieAuth: []
      responses:
        '200':
          description: Logout successful
          headers:
            Set-Cookie:
              schema:
                type: string
              description: Clears access_token and refresh_token cookies
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/LogoutResponse'
        '500':
          $ref: '#/components/responses/InternalError'

  /refresh:
    post:
      tags:
        - Authentication
      summary: Refresh access token
      description: |
        Generate a new access token using a valid refresh token.

        The refresh token is automatically read from the HTTP-only cookie.
      operationId: refreshToken
      security:
        - cookieAuth: []
      responses:
        '200':
          description: Token refreshed successfully
          headers:
            Set-Cookie:
              schema:
                type: string
              description: Sets new access_token cookie
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/RefreshResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /users:
    post:
      tags:
        - Users
      summary: Create a new user
      description: |
        Register a new user account.

        Validates that username and email are unique, and password meets security requirements.
      operationId: createUser
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateUserRequest'
            example:
              username: johndoe
              email: john@example.com
              password: securepassword123
              first_name: John
              last_name: Doe
      responses:
        '201':
          description: User created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

    get:
      tags:
        - Users
      summary: Get authenticated user
      description: |
        Retrieve the profile data for the currently authenticated user.

        Requires a valid access token in cookies.
      operationId: getUser
      security:
        - cookieAuth: []
      responses:
        '200':
          description: User retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/UserResponse'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

  /climbs:
    post:
      tags:
        - Climbs
      summary: Create a new climb
      description: |
        Log a new climbing activity.

        Requires authentication. Optionally link the climb to a route or gym.
      operationId: createClimb
      security:
        - cookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateClimbRequest'
            example:
              climb_type: outdoor
              climb_date: "2024-01-15T10:30:00Z"
              grade: "5.11a"
              style: "redpoint"
              completed: true
              attempts: 3
              falls: 1
              rating: 4
              notes: "Great route with challenging crux"
      responses:
        '201':
          description: Climb created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/ClimbResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

    get:
      tags:
        - Climbs
      summary: Get user climbs
      description: |
        Retrieve climbing activities for a specific user with optional date range filtering.

        Results are returned in descending order by climb date (most recent first).
      operationId: getClimbs
      parameters:
        - name: user_id
          in: query
          required: true
          description: The ID of the user whose climbs to retrieve
          schema:
            type: integer
            format: uint
            example: 1
        - name: start_date
          in: query
          required: false
          description: Start date for filtering climbs (RFC3339 format)
          schema:
            type: string
            format: date-time
            example: "2024-01-01T00:00:00Z"
        - name: end_date
          in: query
          required: false
          description: End date for filtering climbs (RFC3339 format)
          schema:
            type: string
            format: date-time
            example: "2024-12-31T23:59:59Z"
      responses:
        '200':
          description: Climbs retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          climbs:
                            type: array
                            items:
                              $ref: '#/components/schemas/ClimbResponse'
                          count:
                            type: integer
                            description: Total number of climbs returned
                          user_id:
                            type: integer
                            description: User ID for which climbs were retrieved
                          start_date:
                            type: string
                            format: date-time
                            description: Start date used for filtering
                          end_date:
                            type: string
                            format: date-time
                            description: End date used for filtering
        '400':
          $ref: '#/components/responses/BadRequest'
        '500':
          $ref: '#/components/responses/InternalError'

  /gyms:
    post:
      tags:
        - Gyms
      summary: Create a new gym
      description: |
        Add a new climbing gym to the database.

        Requires authentication. All gym attributes can be specified including location,
        facilities, pricing, and contact information.
      operationId: createGym
      security:
        - cookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateGymRequest'
            example:
              name: "Brooklyn Boulders"
              type: "full"
              city: "Brooklyn"
              country: "USA"
              state: "New York"
              address: "575 Degraw St"
              postal_code: "11217"
              description: "Premier climbing facility with bouldering and rope climbing"
              phone: "+1-718-555-0123"
              email: "info@brooklynboulders.com"
              website: "https://brooklynboulders.com"
              has_bouldering: true
              has_top_rope: true
              has_lead_climbing: true
              has_gear_rental: true
              has_cafe: true
              active: true
      responses:
        '201':
          description: Gym created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/FullGymResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '422':
          description: Validation error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIResponse'
        '500':
          $ref: '#/components/responses/InternalError'

    get:
      tags:
        - Gyms
      summary: Get gyms
      description: |
        Retrieve climbing gym information.

        If the `id` query parameter is provided, returns a specific gym.
        If no `id` is provided, returns all gyms in the database ordered by name.

        Requires authentication.
      operationId: getGyms
      security:
        - cookieAuth: []
      parameters:
        - name: id
          in: query
          required: false
          description: Optional gym ID to retrieve a specific gym
          schema:
            type: integer
            format: uint
            example: 1
      responses:
        '200':
          description: Gym(s) retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        oneOf:
                          - $ref: '#/components/schemas/FullGymResponse'
                          - type: object
                            properties:
                              gyms:
                                type: array
                                items:
                                  $ref: '#/components/schemas/FullGymResponse'
                              count:
                                type: integer
                                description: Total number of gyms returned
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          description: Gym not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/APIResponse'
        '500':
          $ref: '#/components/responses/InternalError'

  /training-sessions:
    get:
      tags:
        - Training Sessions
      summary: Get user training sessions
      description: |
        Retrieve training sessions for the authenticated user with optional date range filtering.

        Results are returned in descending order by session date (most recent first).
        User ID is automatically extracted from the authentication context.
      operationId: getTrainingSessions
      security:
        - cookieAuth: []
      parameters:
        - name: start_date
          in: query
          required: false
          description: Start date for filtering training sessions (RFC3339 format). If not provided, queries from the beginning of time.
          schema:
            type: string
            format: date-time
            example: "2024-01-01T00:00:00Z"
        - name: end_date
          in: query
          required: false
          description: End date for filtering training sessions (RFC3339 format). If not provided, queries until now.
          schema:
            type: string
            format: date-time
            example: "2024-12-31T23:59:59Z"
      responses:
        '200':
          description: Training sessions retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          training_sessions:
                            type: array
                            items:
                              $ref: '#/components/schemas/TrainingSessionResponse'
                          count:
                            type: integer
                            description: Total number of training sessions returned
                          start_date:
                            type: string
                            format: date-time
                            description: Start date used for filtering
                          end_date:
                            type: string
                            format: date-time
                            description: End date used for filtering
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

    post:
      tags:
        - Training Sessions
      summary: Create a new training session
      description: |
        Log a new climbing training session at a gym with boulders and rope climbs.

        Requires authentication. Each session must be linked to a climbing gym and can
        optionally have training partners associated with it.
      operationId: createTrainingSession
      security:
        - cookieAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateTrainingSessionRequest'
            example:
              gym_id: 1
              session_date: "2024-01-20T14:00:00Z"
              description: "Great afternoon session with some challenging routes"
              partner_ids: [2, 3]
              boulders:
                - grade: "V5"
                  color_tag: "Blue"
                  outcome: "Flash"
                  notes: "Nice overhang problem"
                - grade: "V7"
                  outcome: "Fell"
                  notes: "Struggled with the crux"
              rope_climbs:
                - climb_type: "Lead"
                  grade: "5.11a"
                  outcome: "Redpoint"
                  notes: "Finally sent it after 3 attempts"
                - climb_type: "TR"
                  grade: "5.10c"
                  outcome: "Flash"
      responses:
        '201':
          description: Training session created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/APIResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/TrainingSessionResponse'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '500':
          $ref: '#/components/responses/InternalError'

components:
  securitySchemes:
    cookieAuth:
      type: apiKey
      in: cookie
      name: access_token
      description: JWT access token stored in HTTP-only cookie

  schemas:
    APIResponse:
      type: object
      description: Standardized response structure for all API endpoints
      required:
        - service_name
        - version
        - environment
        - api_name
        - request_id
        - timestamp
        - status
      properties:
        service_name:
          type: string
          description: Name of the API service
          example: crux-backend
        version:
          type: string
          description: API version
          example: "1.0.0"
        environment:
          type: string
          description: Deployment environment
          example: development
          enum:
            - development
            - staging
            - production
        api_name:
          type: string
          description: Name of the API endpoint
          example: get_user
        request_id:
          type: string
          description: Unique identifier for request tracing
          example: "123e4567-e89b-12d3-a456-426614174000"
        timestamp:
          type: string
          format: date-time
          description: Response generation timestamp
        status:
          type: string
          description: Response status
          enum:
            - success
            - error
        message:
          type: string
          description: Human-readable message
        data:
          type: object
          description: Endpoint-specific response data
        error:
          $ref: '#/components/schemas/APIError'

    APIError:
      type: object
      description: Structured error information
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: Error code
          example: INVALID_INPUT
          enum:
            - INVALID_INPUT
            - NOT_FOUND
            - UNAUTHORIZED
            - FORBIDDEN
            - INTERNAL_ERROR
            - DATABASE_ERROR
            - VALIDATION_FAILED
        message:
          type: string
          description: Human-readable error message
          example: Username is required
        details:
          type: object
          description: Additional error context

    LoginRequest:
      type: object
      required:
        - password
      properties:
        username:
          type: string
          description: Username for login (mutually exclusive with email)
          example: johndoe
        email:
          type: string
          format: email
          description: Email for login (mutually exclusive with username)
          example: john@example.com
        password:
          type: string
          format: password
          description: User password
          example: securepassword123

    LoginResponse:
      type: object
      required:
        - user
        - session_id
        - expires_at
        - message
      properties:
        user:
          $ref: '#/components/schemas/UserResponse'
        session_id:
          type: string
          description: Session identifier
          example: "550e8400-e29b-41d4-a716-446655440000"
        expires_at:
          type: string
          format: date-time
          description: Session expiration time
        message:
          type: string
          example: Login successful

    LogoutResponse:
      type: object
      required:
        - message
      properties:
        message:
          type: string
          example: Logout successful

    RefreshResponse:
      type: object
      required:
        - message
        - expires_at
      properties:
        message:
          type: string
          example: Access token refreshed successfully
        expires_at:
          type: string
          format: date-time
          description: New access token expiration time

    CreateUserRequest:
      type: object
      required:
        - username
        - email
        - password
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
          description: Unique username
          example: johndoe
        email:
          type: string
          format: email
          maxLength: 100
          description: Unique email address
          example: john@example.com
        password:
          type: string
          format: password
          minLength: 8
          maxLength: 72
          description: User password (8-72 characters)
          example: securepassword123
        first_name:
          type: string
          maxLength: 100
          description: User's first name
          example: John
        last_name:
          type: string
          maxLength: 100
          description: User's last name
          example: Doe

    UserResponse:
      type: object
      required:
        - id
        - username
        - email
        - created_at
        - updated_at
      properties:
        id:
          type: integer
          format: uint
          description: User ID
          example: 1
        username:
          type: string
          description: Username
          example: johndoe
        email:
          type: string
          format: email
          description: Email address
          example: john@example.com
        first_name:
          type: string
          description: First name
          example: John
        last_name:
          type: string
          description: Last name
          example: Doe
        created_at:
          type: string
          format: date-time
          description: Account creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    CreateClimbRequest:
      type: object
      required:
        - climb_type
        - climb_date
        - grade
      properties:
        climb_type:
          type: string
          description: Type of climb
          enum:
            - indoor
            - outdoor
          example: outdoor
        climb_date:
          type: string
          format: date-time
          description: Date of the climb (cannot be in the future)
          example: "2024-01-15T10:30:00Z"
        grade:
          type: string
          minLength: 1
          maxLength: 20
          description: Climb grade/difficulty
          example: "5.11a"
        route_id:
          type: integer
          format: uint
          description: Optional route ID for outdoor climbs
          example: 123
        gym_id:
          type: integer
          format: uint
          description: Optional gym ID for indoor climbs
          example: 45
        style:
          type: string
          maxLength: 50
          description: Climbing style
          example: redpoint
        completed:
          type: boolean
          description: Whether the climb was completed
          default: false
          example: true
        attempts:
          type: integer
          minimum: 0
          description: Number of attempts
          default: 1
          example: 3
        falls:
          type: integer
          minimum: 0
          description: Number of falls
          default: 0
          example: 1
        rating:
          type: integer
          minimum: 0
          maximum: 5
          description: Personal rating (0-5)
          example: 4
        notes:
          type: string
          maxLength: 1000
          description: Personal notes about the climb
          example: "Great route with challenging crux"

    ClimbResponse:
      type: object
      required:
        - id
        - user_id
        - climb_type
        - climb_date
        - grade
        - completed
        - attempts
        - created_at
        - updated_at
      properties:
        id:
          type: integer
          format: uint
          description: Climb ID
          example: 1
        user_id:
          type: integer
          format: uint
          description: User ID who logged the climb
          example: 1
        climb_type:
          type: string
          description: Type of climb
          enum:
            - indoor
            - outdoor
          example: outdoor
        climb_date:
          type: string
          format: date-time
          description: Date of the climb
        grade:
          type: string
          description: Climb grade
          example: "5.11a"
        style:
          type: string
          description: Climbing style
          example: redpoint
        route_id:
          type: integer
          format: uint
          description: Associated route ID
          example: 123
        gym_id:
          type: integer
          format: uint
          description: Associated gym ID
          example: 45
        completed:
          type: boolean
          description: Whether the climb was completed
          example: true
        attempts:
          type: integer
          description: Number of attempts
          example: 3
        falls:
          type: integer
          description: Number of falls
          example: 1
        rating:
          type: integer
          description: Personal rating (0-5)
          example: 4
        notes:
          type: string
          description: Personal notes
          example: "Great route with challenging crux"
        created_at:
          type: string
          format: date-time
          description: Record creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    IndoorBoulderRequest:
      type: object
      required:
        - grade
        - outcome
      properties:
        grade:
          type: string
          minLength: 1
          maxLength: 20
          description: V-scale grade (e.g., "V3", "V5")
          example: "V5"
        color_tag:
          type: string
          maxLength: 50
          description: Optional color tag for the indoor boulder
          example: "Blue"
        outcome:
          type: string
          description: Outcome of the indoor boulder attempt
          enum:
            - Fell
            - Flash
            - Onsite
            - Redpoint
          example: "Flash"
        notes:
          type: string
          maxLength: 1000
          description: Personal notes about this indoor boulder
          example: "Nice overhang problem"

    RopeClimbRequest:
      type: object
      required:
        - climb_type
        - grade
        - outcome
      properties:
        climb_type:
          type: string
          description: Type of rope climb
          enum:
            - TR
            - Lead
          example: "Lead"
        grade:
          type: string
          minLength: 1
          maxLength: 20
          description: YDS grade (e.g., "5.10a", "5.11d")
          example: "5.11a"
        outcome:
          type: string
          description: Outcome of the climb attempt
          enum:
            - Fell
            - Hung
            - Flash
            - Onsite
            - Redpoint
          example: "Redpoint"
        notes:
          type: string
          maxLength: 1000
          description: Personal notes about this climb
          example: "Finally sent it after 3 attempts"

    CreateTrainingSessionRequest:
      type: object
      required:
        - gym_id
        - session_date
      properties:
        gym_id:
          type: integer
          format: uint
          description: ID of the gym where the session took place
          example: 1
        session_date:
          type: string
          format: date-time
          description: Date and time of the training session (cannot be in the future)
          example: "2024-01-20T14:00:00Z"
        description:
          type: string
          maxLength: 1000
          description: Optional description of the training session
          example: "Great afternoon session with some challenging routes"
        partner_ids:
          type: array
          items:
            type: integer
            format: uint
          description: Optional list of user IDs who were training partners
          example: [2, 3]
        indoor_boulders:
          type: array
          items:
            $ref: '#/components/schemas/IndoorBoulderRequest'
          description: List of indoor boulder problems climbed during the session
        rope_climbs:
          type: array
          items:
            $ref: '#/components/schemas/RopeClimbRequest'
          description: List of rope climbs completed during the session

    IndoorBoulderResponse:
      type: object
      required:
        - id
        - training_session_id
        - grade
        - outcome
        - created_at
        - updated_at
      properties:
        id:
          type: integer
          format: uint
          description: Indoor boulder ID
          example: 1
        training_session_id:
          type: integer
          format: uint
          description: Training session ID
          example: 1
        grade:
          type: string
          description: V-scale grade
          example: "V5"
        color_tag:
          type: string
          description: Color tag for indoor boulder
          example: "Blue"
        outcome:
          type: string
          description: Outcome of indoor boulder attempt
          enum:
            - Fell
            - Flash
            - Onsite
            - Redpoint
          example: "Flash"
        notes:
          type: string
          description: Notes about indoor boulder
          example: "Nice overhang problem"
        created_at:
          type: string
          format: date-time
          description: Record creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    RopeClimbResponse:
      type: object
      required:
        - id
        - training_session_id
        - climb_type
        - grade
        - outcome
        - created_at
        - updated_at
      properties:
        id:
          type: integer
          format: uint
          description: Rope climb ID
          example: 1
        training_session_id:
          type: integer
          format: uint
          description: Training session ID
          example: 1
        climb_type:
          type: string
          description: Type of rope climb
          enum:
            - TR
            - Lead
          example: "Lead"
        grade:
          type: string
          description: YDS grade
          example: "5.11a"
        outcome:
          type: string
          description: Outcome
          enum:
            - Fell
            - Hung
            - Flash
            - Onsite
            - Redpoint
          example: "Redpoint"
        notes:
          type: string
          description: Notes
          example: "Finally sent it after 3 attempts"
        created_at:
          type: string
          format: date-time
          description: Record creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    PartnerResponse:
      type: object
      required:
        - id
        - username
      properties:
        id:
          type: integer
          format: uint
          description: User ID
          example: 2
        username:
          type: string
          description: Username
          example: "climbbuddy"
        first_name:
          type: string
          description: First name
          example: "Jane"
        last_name:
          type: string
          description: Last name
          example: "Smith"

    GymResponse:
      type: object
      required:
        - id
        - name
      properties:
        id:
          type: integer
          format: uint
          description: Gym ID
          example: 1
        name:
          type: string
          description: Gym name
          example: "Brooklyn Boulders"
        city:
          type: string
          description: City
          example: "New York"

    CreateGymRequest:
      type: object
      required:
        - name
        - type
        - city
        - country
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 200
          description: Name of the climbing gym
          example: "Brooklyn Boulders"
        type:
          type: string
          description: Type of climbing facility
          enum:
            - bouldering
            - roped
            - full
          example: "full"
        city:
          type: string
          minLength: 1
          maxLength: 100
          description: City where the gym is located
          example: "Brooklyn"
        country:
          type: string
          minLength: 1
          maxLength: 100
          description: Country where the gym is located
          example: "USA"
        description:
          type: string
          maxLength: 5000
          description: Description of the gym
          example: "Premier climbing facility with bouldering and rope climbing"
        address:
          type: string
          maxLength: 300
          description: Street address
          example: "575 Degraw St"
        state:
          type: string
          maxLength: 100
          description: State (for US/Canada)
          example: "New York"
        province:
          type: string
          maxLength: 100
          description: Province (alternative to state)
          example: "Ontario"
        postal_code:
          type: string
          maxLength: 20
          description: Postal/ZIP code
          example: "11217"
        latitude:
          type: number
          format: double
          minimum: -90
          maximum: 90
          description: GPS latitude coordinate
          example: 40.6782
        longitude:
          type: number
          format: double
          minimum: -180
          maximum: 180
          description: GPS longitude coordinate
          example: -73.9442
        phone:
          type: string
          maxLength: 50
          description: Contact phone number
          example: "+1-718-555-0123"
        email:
          type: string
          format: email
          maxLength: 200
          description: Contact email address
          example: "info@brooklynboulders.com"
        website:
          type: string
          format: uri
          maxLength: 300
          description: Website URL
          example: "https://brooklynboulders.com"
        hours:
          type: string
          maxLength: 1000
          description: Operating hours (free-form text)
          example: "Mon-Fri: 6am-11pm, Sat-Sun: 8am-9pm"
        has_bouldering:
          type: boolean
          description: Has bouldering facilities
          default: false
        has_top_rope:
          type: boolean
          description: Has top rope climbing
          default: false
        has_lead_climbing:
          type: boolean
          description: Has lead climbing
          default: false
        has_auto_belay:
          type: boolean
          description: Has auto belay systems
          default: false
        has_kids_area:
          type: boolean
          description: Has dedicated kids area
          default: false
        has_training_area:
          type: boolean
          description: Has training/workout area
          default: false
        has_yoga_classes:
          type: boolean
          description: Offers yoga classes
          default: false
        has_shower:
          type: boolean
          description: Has shower facilities
          default: false
        has_parking:
          type: boolean
          description: Has parking available
          default: false
        has_gear_rental:
          type: boolean
          description: Offers gear rental
          default: false
        has_pro_shop:
          type: boolean
          description: Has pro shop
          default: false
        has_cafe:
          type: boolean
          description: Has cafe/food service
          default: false
        wall_height:
          type: integer
          minimum: 0
          description: Maximum wall height in feet
          example: 45
        square_feet:
          type: integer
          minimum: 0
          description: Total climbing area in square feet
          example: 22000
        day_pass_price:
          type: number
          format: double
          minimum: 0
          description: Day pass price in dollars
          example: 25.00
        monthly_price:
          type: number
          format: double
          minimum: 0
          description: Monthly membership price in dollars
          example: 95.00
        yearly_price:
          type: number
          format: double
          minimum: 0
          description: Yearly membership price in dollars
          example: 900.00
        gear_rental_price:
          type: number
          format: double
          minimum: 0
          description: Gear rental price in dollars
          example: 5.00
        notes:
          type: string
          maxLength: 5000
          description: Additional notes or comments
          example: "Beginner friendly with excellent route setting"
        active:
          type: boolean
          description: Whether the gym is currently open/operational
          default: true

    FullGymResponse:
      type: object
      required:
        - id
        - name
        - type
        - city
        - country
        - active
        - created_at
        - updated_at
      properties:
        id:
          type: integer
          format: uint
          description: Gym ID
          example: 1
        name:
          type: string
          description: Gym name
          example: "Brooklyn Boulders"
        description:
          type: string
          description: Description
          example: "Premier climbing facility"
        type:
          type: string
          description: Gym type
          enum:
            - bouldering
            - roped
            - full
          example: "full"
        address:
          type: string
          description: Street address
          example: "575 Degraw St"
        city:
          type: string
          description: City
          example: "Brooklyn"
        state:
          type: string
          description: State
          example: "New York"
        province:
          type: string
          description: Province
          example: "Ontario"
        country:
          type: string
          description: Country
          example: "USA"
        postal_code:
          type: string
          description: Postal code
          example: "11217"
        latitude:
          type: number
          format: double
          description: GPS latitude
          example: 40.6782
        longitude:
          type: number
          format: double
          description: GPS longitude
          example: -73.9442
        phone:
          type: string
          description: Phone number
          example: "+1-718-555-0123"
        email:
          type: string
          description: Email
          example: "info@brooklynboulders.com"
        website:
          type: string
          description: Website
          example: "https://brooklynboulders.com"
        hours:
          type: string
          description: Operating hours
          example: "Mon-Fri: 6am-11pm"
        has_bouldering:
          type: boolean
          description: Has bouldering
        has_top_rope:
          type: boolean
          description: Has top rope
        has_lead_climbing:
          type: boolean
          description: Has lead climbing
        has_auto_belay:
          type: boolean
          description: Has auto belay
        has_kids_area:
          type: boolean
          description: Has kids area
        has_training_area:
          type: boolean
          description: Has training area
        has_yoga_classes:
          type: boolean
          description: Has yoga classes
        has_shower:
          type: boolean
          description: Has showers
        has_parking:
          type: boolean
          description: Has parking
        has_gear_rental:
          type: boolean
          description: Has gear rental
        has_pro_shop:
          type: boolean
          description: Has pro shop
        has_cafe:
          type: boolean
          description: Has cafe
        wall_height:
          type: integer
          description: Wall height in feet
          example: 45
        square_feet:
          type: integer
          description: Square footage
          example: 22000
        day_pass_price:
          type: number
          format: double
          description: Day pass price
          example: 25.00
        monthly_price:
          type: number
          format: double
          description: Monthly price
          example: 95.00
        yearly_price:
          type: number
          format: double
          description: Yearly price
          example: 900.00
        gear_rental_price:
          type: number
          format: double
          description: Gear rental price
          example: 5.00
        notes:
          type: string
          description: Notes
          example: "Beginner friendly"
        active:
          type: boolean
          description: Is active
          example: true
        created_at:
          type: string
          format: date-time
          description: Creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

    TrainingSessionResponse:
      type: object
      required:
        - id
        - user_id
        - gym_id
        - session_date
        - total_climbs
        - total_sends
        - created_at
        - updated_at
      properties:
        id:
          type: integer
          format: uint
          description: Training session ID
          example: 1
        user_id:
          type: integer
          format: uint
          description: User ID who logged the session
          example: 1
        gym_id:
          type: integer
          format: uint
          description: Gym ID where the session took place
          example: 1
        session_date:
          type: string
          format: date-time
          description: Session date and time
          example: "2024-01-20T14:00:00Z"
        description:
          type: string
          description: Session description
          example: "Great afternoon session with some challenging routes"
        gym:
          $ref: '#/components/schemas/GymResponse'
        partners:
          type: array
          items:
            $ref: '#/components/schemas/PartnerResponse'
          description: Training partners
        indoor_boulders:
          type: array
          items:
            $ref: '#/components/schemas/IndoorBoulderResponse'
          description: Indoor boulder problems climbed
        rope_climbs:
          type: array
          items:
            $ref: '#/components/schemas/RopeClimbResponse'
          description: Rope climbs completed
        total_climbs:
          type: integer
          description: Total number of climbs (boulders + rope climbs)
          example: 4
        total_sends:
          type: integer
          description: Total number of successful sends
          example: 2
        created_at:
          type: string
          format: date-time
          description: Record creation timestamp
        updated_at:
          type: string
          format: date-time
          description: Last update timestamp

  responses:
    BadRequest:
      description: Bad request - invalid input or validation error
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/APIResponse'
              - type: object
                properties:
                  status:
                    example: error
                  error:
                    $ref: '#/components/schemas/APIError'

    Unauthorized:
      description: Unauthorized - authentication required or invalid credentials
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/APIResponse'
              - type: object
                properties:
                  status:
                    example: error
                  error:
                    type: object
                    properties:
                      code:
                        example: UNAUTHORIZED
                      message:
                        example: Invalid credentials

    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/APIResponse'
              - type: object
                properties:
                  status:
                    example: error
                  error:
                    type: object
                    properties:
                      code:
                        example: INTERNAL_ERROR
                      message:
                        example: An unexpected error occurred
